# 交互模式

Claude Code 会话中键盘快捷键、输入模式和交互功能的完整参考。

## 键盘快捷键

键盘快捷键可能因平台和终端而异。按 `?` 查看您的环境中可用的快捷键。

### 常规控制

快捷键 | 描述 | 上下文
---|---|---
`Ctrl+C` | 取消当前输入或生成 | 标准中断
`Ctrl+D` | 退出 Claude Code 会话 | EOF 信号
`Ctrl+L` | 清除终端屏幕 | 保留对话历史
`Ctrl+O` | 切换详细输出 | 显示详细的工具使用和执行情况
`Ctrl+R` | 反向搜索命令历史 | 交互式搜索以前的命令
`Ctrl+V` (macOS/Linux) 或 `Alt+V` (Windows) | 从剪贴板粘贴图像 | 粘贴图像或图像文件的路径
`Up/Down arrows` | 导航命令历史 | 回忆以前的输入
`Esc` + `Esc` | 回退代码/对话 | 将代码和/或对话恢复到之前的状态
`Tab` | 切换扩展思考 | 在思考开启和思考关闭之间切换
`Shift+Tab` 或 `Alt+M` (某些配置) | 切换权限模式 | 在自动接受模式、计划模式和正常模式之间切换

## 多行输入

方法 | 快捷键 | 上下文
---|---|---
快速转义 | `\` + `Enter` | 适用于所有终端
macOS 默认 | `Option+Enter` | macOS 上的默认设置
终端设置 | `Shift+Enter` | 在 `/terminal-setup` 之后
控制序列 | `Ctrl+J` | 多行的换行符
粘贴模式 | 直接粘贴 | 用于代码块、日志

在终端设置中配置您首选的换行行为。运行 `/terminal-setup` 为 iTerm2 和 VS Code 终端安装 Shift+Enter 绑定。

## 快速命令

快捷键 | 描述 | 备注
---|---|---
`#` | 在开始 内存快捷方式 | 添加到 CLAUDE.md 提示文件选择
`/` | 在开始 斜杠命令 | 参见斜杠命令
`!` | 在开始 Bash 模式 | 直接运行命令并将执行输出添加到会话
`@` | 文件路径提及 | 触发文件路径自动完成

## Vim 编辑器模式

使用 `/vim` 命令启用 vim 风格编辑，或通过 `/config` 永久配置。

## 模式切换

命令 | 操作 | 来自模式
---|---|---
`Esc` | 进入 NORMAL 模式 | INSERT
`i` | 在光标前插入 | NORMAL
`I` | 在行首插入 | NORMAL
`a` | 在光标后插入 | NORMAL
`A` | 在行尾插入 | NORMAL
`o` | 在下方打开行 | NORMAL
`O` | 在上方打开行 | NORMAL

## 导航 (NORMAL 模式)

命令 | 操作
---|---
`h`/`j`/`k`/`l` | 向左/向下/向上/向右移动
`w` | 下一个单词
`e` | 单词末尾
`b` | 上一个单词
`0` | 行首
`$` | 行尾
`^` | 第一个非空白字符
`gg` | 输入开始
`G` | 输入结束

## 编辑 (NORMAL 模式)

命令 | 操作
---|---
`x` | 删除字符
`dd` | 删除行
`D` | 删除到行尾
`dw`/`de`/`db` | 删除单词/到末尾/向后
`cc` | 更改行
`C` | 更改到行尾
`cw`/`ce`/`cb` | 更改单词/到末尾/向后
`.` | 重复上次更改

## 命令历史

Claude Code 为当前会话维护命令历史：

* 历史记录按工作目录存储
* 使用 `/clear` 命令清除
* 使用上/下箭头导航（参见上面的键盘快捷键）
* 注意：历史扩展 (`!`) 默认禁用

### 使用 Ctrl+R 反向搜索

按 `Ctrl+R` 交互式搜索您的命令历史：

1. 开始搜索：按 `Ctrl+R` 激活反向历史搜索  
2. 输入查询：输入文本以在以前的命令中搜索 — 搜索词将在匹配结果中突出显示  
3. 导航匹配：再次按 `Ctrl+R` 循环浏览较旧的匹配项  
4. 接受匹配：  
   * 按 `Tab` 或 `Esc` 接受当前匹配并继续编辑  
   * 按 `Enter` 接受并立即执行命令  
5. 取消搜索：  
   * 按 `Ctrl+C` 取消并恢复原始输入  
   * 在空搜索上按 `Backspace` 取消

搜索显示匹配的命令，搜索词突出显示，使您可以轻松找到并重用以前的输入。

## 后台 bash 命令

Claude Code 支持在后台运行 bash 命令，允许您在长时间运行的进程执行时继续工作。

### 后台运行的工作原理

当 Claude Code 在后台运行命令时，它异步运行命令并立即返回后台任务 ID。Claude Code 可以在命令继续在后台执行时响应新提示。要在后台运行命令，您可以：

* 提示 Claude Code 在后台运行命令  
* 按 `Ctrl+B` 将常规 Bash 工具调用移到后台。（Tmux 用户必须按 `Ctrl+B` 两次，因为 tmux 的前缀键。）

主要功能：

* 输出被缓冲，Claude 可以使用 BashOutput 工具检索它  
* 后台任务具有唯一的 ID 用于跟踪和输出检索  
* 当 Claude Code 退出时，后台任务会自动清理

常见的后台命令：

* 构建工具（webpack, vite, make）  
* 包管理器（npm, yarn, pnpm）  
* 测试运行器（jest, pytest）  
* 开发服务器  
* 长时间运行的进程（docker, terraform）

## 使用 `!` 前缀的 Bash 模式

通过在输入前加上 `!` 直接运行 bash 命令，无需通过 Claude：

```bash
! npm test
! git status
! ls -la
```
